hd_pi_RR_mp %>% plot.hd.mod()
hd_pi_SZ_mp %>% plot.hd.mod()
svar_hd_cv <- hd(x = CV, series = 2)
svar_hd_dc <- hd(x = dCov, series = 2)
svar_hd_cv$hidec == hd_pi_CV
svar_hd_cv$hidec %>% select(-1) == hd_pi_CV %>% select(-1)
svar_hd_cv$hidec %>% select(-1)
svar_hd_cv$hidec %>% dplyr::select(-1) == hd_pi_CV %>% dplyr::select(-1)
hd_pi_CV %>% dplyr::select(-1)
hd_pi_CV %>% dplyr::select(-1) %>% dim
svar_hd_cv$hidec %>% dplyr::select(-1) %>% dim
svar_hd_cv$hidec %>% CLASS
svar_hd_cv$hidec %>% class()
svar_hd_cv$hidec %>% as.data.frame() %>%  dplyr::select(-1) %>% dim
svar_hd_cv$hidec %>% as.data.frame()
svar_hd_cv$hidec %>% as.data.frame() == hd_pi_CV %>% dplyr::select(-1)
svar_hd_cv$hidec %>% as.data.frame() - hd_pi_CV %>% dplyr::select(-1)
svar_hd_cv %>% plot
hd_pi_CV %>% plot.hd.mod()
graphics.off()
svar_hd_dc %>% plot
hd_pi_dCov %>% plot.hd.mod()
svar_hd_dc$hidec %>% as.data.frame() - hd_pi_dCov %>% dplyr::select(-1)
hd_pi_dCov %>% plot.hd.mod()
hd_pi_SR <- hd.mod(SR, series = 2, Partial = NULL, Epsname)
hd_pi_SR_mp <- hd.mod(SR, series = 2, Partial = 3, Epsname)
hd_pi_CV <- hd.mod(CV, series = 2, Partial = NULL, Epsname)
hd_pi_CV_mp <- hd.mod(CV, series = 2, Partial = 3, Epsname)
hd_pi_dCov <- hd.mod(dCov, series = 2, Partial = NULL, Epsname)
hd_pi_dCov_mp <- hd.mod(dCov, series = 2, Partial = 3, Epsname)
hd_pi_SW_mp <- hd.mod(IV.SW, series = 2, Partial = 3, Epsname)
hd_pi_RR_mp <- hd.mod(IV.RR, series = 2, Partial = 3, Epsname)
hd_pi_SZ_mp <- hd.mod(IV.SZ, series = 2, Partial = 3, Epsname)
hd_pi_CV_mp
hd_pi_SR %>% plot.hd.mod()
hd_pi_CV %>% plot.hd.mod()
«hd_pi_dCov %>% plot.hd.mod()
hd_pi_dCov %>% plot.hd.mod()
hd_pi_CV %>% plot.hd.mod()
hd_pi_SW_mp %>% plot.hd.mod()
hd_pi_RR_mp %>% plot.hd.mod()
hd_pi_SZ_mp %>% plot.hd.mod()
# x ----------------------------------------------------------------------
hd_x_SR <- hd.mod(SR, series = 1, Partial = NULL, Epsname)
hd_x_SR_mp <- hd.mod(SR, series = 1, Partial = 3, Epsname)
hd_x_CV <- hd.mod(CV, series = 1, Partial = NULL, Epsname)
hd_x_CV_mp <- hd.mod(CV, series = 1, Partial = 3, Epsname)
hd_x_dCov <- hd.mod(dCov, series = 1, Partial = NULL, Epsname)
hd_x_dCov_mp <- hd.mod(dCov, series = 1, Partial = 3, Epsname)
hd_x_SW_mp <- hd.mod(IV.SW, series = 1, Partial = 3, Epsname)
hd_x_RR_mp <- hd.mod(IV.RR, series = 1, Partial = 3, Epsname)
hd_x_SZ_mp <- hd.mod(IV.SZ, series = 1, Partial = 3, Epsname)
hd_x_SR %>% plot.hd.mod()
hd_x_CV %>% plot.hd.mod()
«hd_x_CV %>% plot.hd.mod()
hd_x_CV %>% plot.hd.mod()
hd_x_SR %>% plot.hd.mod()
hd_x_CV %>% plot.hd.mod()
hd_x_dCov %>% plot.hd.mod()
hd_x_SW_mp %>% plot.hd.mod()
hd_x_RR_mp %>% plot.hd.mod()
hd_x_SZ_mp %>% plot.hd.mod()
## combined plot
hd_pi_mp <- hd_pi_SR_mp %>% left_join(hd_pi_dCov_mp, by = "t") %>%
left_join(hd_pi_CV_mp, by = "t") %>% left_join(hd_pi_SW_mp, by = "t") %>%
left_join(hd_pi_SZ_mp, by = "t") %>% left_join(hd_pi_RR_mp, by = "t")
hd_pi_mp
hd_pi_SR_mp %>% left_join(hd_pi_dCov_mp, by = "t")
hd_pi_mp %>% dim
## combined plot
hd_pi_mp <- hd_pi_SR_mp %>% left_join(hd_pi_dCov_mp, by = "t") %>%
left_join(hd_pi_CV_mp, by = "t") %>% left_join(hd_pi_SW_mp, by = "t") %>%
left_join(hd_pi_SZ_mp, by = "t") %>% left_join(hd_pi_RR_mp, by = "t") %>% tidyr::drop_na()
colnames(hd_pi_mp)[-1]
colnames(hd_pi_mp)[-1] <- c("SR", "dCov", "CV", "SW", "SZ", "RR")
hd_pi_mp %>% reshape2::melt(id = "t") %>% ggplot(aes(x = t, y = value)) %>%
geom_line() + facet_wrap(~variable, ncol = 2) +
xlab("") + ylab("") + theme_bw()
hd_pi_mp %>% reshape2::melt(id = "t") %>% ggplot(aes(x = t, y = value)) +
geom_line() + facet_wrap(~variable, ncol = 2) +
xlab("") + ylab("") + theme_bw()
hd_pi_mp %>% reshape2::melt(id = "t") %>% ggplot(aes(x = t, y = value)) +
geom_line() + facet_wrap(~variable, ncol = 3) +
xlab("") + ylab("") + theme_bw()
hd_pi_mp
hd_pi_mp %<>% dplyr::filter(t >= 1970 & t <= 1985)
colnames(hd_pi_mp)[-1] <- c("SR", "dCov", "CV", "SW", "SZ", "RR")
hd_pi_mp %>% reshape2::melt(id = "t") %>% ggplot(aes(x = t, y = value)) +
geom_line() + facet_wrap(~variable, ncol = 3) +
xlab("") + ylab("") + theme_bw()
## combined plot
hd_x_mp <- hd_x_SR_mp %>% left_join(hd_x_dCov_mp, by = "t") %>%
left_join(hd_x_CV_mp, by = "t") %>% left_join(hd_x_SW_mp, by = "t") %>%
left_join(hd_x_SZ_mp, by = "t") %>% left_join(hd_x_RR_mp, by = "t") %>% tidyr::drop_na()
hd_x_mp %<>% dplyr::filter(t >= 1970 & t <= 1985)
colnames(hd_x_mp)[-1] <- c("SR", "dCov", "CV", "SW", "SZ", "RR")
hd_x_mp %>% reshape2::melt(id = "t") %>% ggplot(aes(x = t, y = value)) +
geom_line() + facet_wrap(~variable, ncol = 3) +
xlab("") + ylab("") + theme_bw()
hd_pi_mp %>% reshape2::melt(id = "t") %>% ggplot(aes(x = t, y = value)) +
geom_line() + facet_wrap(~variable, ncol = 3) +
xlab("") + ylab("") + theme_bw() + geom_hline(yintercept = 0, color = "red", alpha = 0.8)
hd_pi_mp %>% reshape2::melt(id = "t") %>% ggplot(aes(x = t, y = value)) +
geom_line() + facet_wrap(~variable, ncol = 3) + xlab("") + ylab("") +
theme_bw() + geom_hline(yintercept = 0, color = "red", alpha = 0.7)
hd_pi_mp %>% reshape2::melt(id = "t") %>% ggplot(aes(x = t, y = value)) +
geom_line() + facet_wrap(~variable, ncol = 3) + xlab("") + ylab("") +
theme_bw() + geom_hline(yintercept = 0, color = "red", alpha = 0.4)
hd_pi_mp %>% reshape2::melt(id = "t") %>% ggplot(aes(x = t, y = value)) +
geom_line() + facet_wrap(~variable, ncol = 3) + xlab("") + ylab("") +
theme_bw() + geom_hline(yintercept = 0, color = "red", alpha = 0.5)
hd_x_mp %>% reshape2::melt(id = "t") %>% ggplot(aes(x = t, y = value)) +
geom_line() + facet_wrap(~variable, ncol = 3) + xlab("") + ylab("") +
theme_bw() + geom_hline(yintercept = 0, color = "red", alpha = 0.5)
hd_pi_SZ_mp <- hd.mod(IV.SZ, series = 2, Partial = 3, Epsname)
recessions_start <- c(1969.75, 1973.75, 1980)
recessions_end <- c(1970.75, 1975, 1982.75)
hd_pi_mp %>% reshape2::melt(id = "t") %>% ggplot(aes(x = t, y = value)) +
geom_line() + facet_wrap(~variable, ncol = 3) + xlab("") + ylab("") +
theme_bw() + geom_hline(yintercept = 0, color = "red", alpha = 0.5) +
annotate("rect", xmin = recessions_start, xmax = recessions_end, ymin = -Inf, ymax = Inf, alpha = 0.3)
hd_pi_mp_plot <- hd_pi_mp %>% reshape2::melt(id = "t") %>% ggplot(aes(x = t, y = value)) +
geom_line() + facet_wrap(~variable, ncol = 3) + xlab("") + ylab("") +
theme_bw() + geom_hline(yintercept = 0, color = "red", alpha = 0.5) +
annotate("rect", xmin = recessions_start, xmax = recessions_end, ymin = -Inf, ymax = Inf, alpha = 0.3)
ggsave("../Plots/hd_pi_mp.pdf", plot = hd_pi_mp_plot, width = 12, height = 6)
USA_Tri %>% plo0t
USA_Tri %>% plot
recessions_end <- c(1970.75, 1975, 1980.5,1982.75)
recessions_start <- c(1969.75, 1973.75, 1980,1981.5)
recessions_end <- c(1970.75, 1975, 1980.5,1982.75)
hd_pi_mp_plot <- hd_pi_mp %>% reshape2::melt(id = "t") %>% ggplot(aes(x = t, y = value)) +
geom_line() + facet_wrap(~variable, ncol = 3) + xlab("") + ylab("") +
theme_bw() + geom_hline(yintercept = 0, color = "red", alpha = 0.5) +
annotate("rect", xmin = recessions_start, xmax = recessions_end, ymin = -Inf, ymax = Inf, alpha = 0.3)
ggsave("../Plots/hd_pi_mp.pdf", plot = hd_pi_mp_plot, width = 12, height = 6)
hd_pi_mp_plot <- hd_pi_mp %>% reshape2::melt(id = "t") %>% ggplot(aes(x = t, y = value)) +
geom_line() + facet_wrap(~variable, ncol = 3) + xlab("") + ylab("") +
theme_bw() + geom_hline(yintercept = 0, color = "red", alpha = 0.5) +
scale_x_continuous(breaks = seq(hd_pi_mp$t[1] %>% ceiling(),hd_pi_mp$t[nrow(hd_pi_mp)], 2)) +
annotate("rect", xmin = recessions_start, xmax = recessions_end, ymin = -Inf, ymax = Inf, alpha = 0.3)
hd_pi_mp_plot
hd_pi_mp_plot <- hd_pi_mp %>% reshape2::melt(id = "t") %>% ggplot(aes(x = t, y = value)) +
geom_line() + facet_wrap(~variable, ncol = 3) + xlab("") + ylab("") +
theme_bw() + geom_hline(yintercept = 0, color = "red", alpha = 0.5) +
scale_x_continuous(breaks = seq(hd_pi_mp$t[1] %>% ceiling(),hd_pi_mp$t[nrow(hd_pi_mp)], 0.5)) +
annotate("rect", xmin = recessions_start, xmax = recessions_end, ymin = -Inf, ymax = Inf, alpha = 0.3)
ggsave("../Plots/hd_pi_mp.pdf", plot = hd_pi_mp_plot, width = 12, height = 6)
hd_pi_mp_plot <- hd_pi_mp %>% reshape2::melt(id = "t") %>% ggplot(aes(x = t, y = value)) +
geom_line() + facet_wrap(~variable, ncol = 3) + xlab("") + ylab("") +
theme_bw() + geom_hline(yintercept = 0, color = "red", alpha = 0.5) +
scale_x_continuous(breaks = seq(hd_pi_mp$t[1] %>% ceiling(),hd_pi_mp$t[nrow(hd_pi_mp)], 1)) +
annotate("rect", xmin = recessions_start, xmax = recessions_end, ymin = -Inf, ymax = Inf, alpha = 0.3)
ggsave("../Plots/hd_pi_mp.pdf", plot = hd_pi_mp_plot, width = 12, height = 6)
hd_pi_mp_plot <- hd_pi_mp %>% reshape2::melt(id = "t") %>% ggplot(aes(x = t, y = value)) +
geom_line() + facet_wrap(~variable, ncol = 3) + xlab("") + ylab("") +
theme_bw() + geom_hline(yintercept = 0, color = "red", alpha = 0.5) +
scale_x_continuous(breaks = seq(hd_pi_mp$t[1] %>% ceiling(),hd_pi_mp$t[nrow(hd_pi_mp)], 2)) +
annotate("rect", xmin = recessions_start, xmax = recessions_end, ymin = -Inf, ymax = Inf, alpha = 0.3)
ggsave("../Plots/hd_pi_mp.pdf", plot = hd_pi_mp_plot, width = 12, height = 6)
hd_pi_mp_plot <- hd_pi_mp %>% reshape2::melt(id = "t") %>% ggplot(aes(x = t, y = value)) +
geom_line() + facet_wrap(~variable, ncol = 3) + xlab("") + ylab("") +
theme_bw() + geom_hline(yintercept = 0, color = "red", alpha = 0.5) +
scale_x_continuous(breaks = seq(hd_pi_mp$t[1] %>% ceiling(),hd_pi_mp$t[nrow(hd_pi_mp)], 2.5)) +
annotate("rect", xmin = recessions_start, xmax = recessions_end, ymin = -Inf, ymax = Inf, alpha = 0.3)
ggsave("../Plots/hd_pi_mp.pdf", plot = hd_pi_mp_plot, width = 12, height = 6)
hd_pi_mp_plot <- hd_pi_mp %>% reshape2::melt(id = "t") %>% ggplot(aes(x = t, y = value)) +
geom_line() + facet_wrap(~variable, ncol = 3) + xlab("") + ylab("") +
theme_bw() + geom_hline(yintercept = 0, color = "red", alpha = 0.5) +
scale_x_continuous(breaks = seq(hd_pi_mp$t[1] %>% ceiling(),hd_pi_mp$t[nrow(hd_pi_mp)], 3)) +
annotate("rect", xmin = recessions_start, xmax = recessions_end, ymin = -Inf, ymax = Inf, alpha = 0.3)
ggsave("../Plots/hd_pi_mp.pdf", plot = hd_pi_mp_plot, width = 12, height = 6)
scale_x_continuous(breaks = seq(hd_pi_mp$t[1] %>% ceiling(),hd_pi_mp$t[nrow(hd_pi_mp)], 4) +
ggsave("../Plots/hd_pi_mp.pdf", plot = hd_pi_mp_plot, width = 12, height = 6)
scale_x_continuous(breaks = seq(hd_pi_mp$t[1] %>% ceiling(),hd_pi_mp$t[nrow(hd_pi_mp)], 5) +
ggsave("../Plots/hd_pi_mp.pdf", plot = hd_pi_mp_plot, width = 12, height = 6)
hd_pi_mp_plot <- hd_pi_mp %>% reshape2::melt(id = "t") %>% ggplot(aes(x = t, y = value)) +
geom_line() + facet_wrap(~variable, ncol = 3) + xlab("") + ylab("") +
theme_bw() + geom_hline(yintercept = 0, color = "red", alpha = 0.5) +
scale_x_continuous(breaks = seq(hd_pi_mp$t[1] %>% ceiling(),hd_pi_mp$t[nrow(hd_pi_mp)], 4)) +
annotate("rect", xmin = recessions_start, xmax = recessions_end, ymin = -Inf, ymax = Inf, alpha = 0.3)
ggsave("../Plots/hd_pi_mp.pdf", plot = hd_pi_mp_plot, width = 12, height = 6)
hd_pi_mp_plot <- hd_pi_mp %>% reshape2::melt(id = "t") %>% ggplot(aes(x = t, y = value)) +
geom_line() + facet_wrap(~variable, ncol = 3) + xlab("") + ylab("") +
theme_bw() + geom_hline(yintercept = 0, color = "red", alpha = 0.5) +
scale_x_continuous(breaks = seq(hd_pi_mp$t[1] %>% ceiling(),hd_pi_mp$t[nrow(hd_pi_mp)], 2)) +
annotate("rect", xmin = recessions_start, xmax = recessions_end, ymin = -Inf, ymax = Inf, alpha = 0.3)
ggsave("../Plots/hd_pi_mp.pdf", plot = hd_pi_mp_plot, width = 12, height = 6)
hd_pi_mp_plot <- hd_pi_mp %>% reshape2::melt(id = "t") %>% ggplot(aes(x = t, y = value)) +
geom_line() + facet_wrap(~variable, ncol = 3) + xlab("") + ylab("") +
theme_bw() + geom_hline(yintercept = 0, color = "red", alpha = 0.5) +
scale_x_continuous(breaks = seq(hd_pi_mp$t[1] %>% ceiling(),hd_pi_mp$t[nrow(hd_pi_mp)], 1)) +
annotate("rect", xmin = recessions_start, xmax = recessions_end, ymin = -Inf, ymax = Inf, alpha = 0.3)
ggsave("../Plots/hd_pi_mp.pdf", plot = hd_pi_mp_plot, width = 12, height = 6)
hd_pi_mp_plot <- hd_pi_mp %>% reshape2::melt(id = "t") %>% ggplot(aes(x = t, y = value)) +
geom_line() + facet_wrap(~variable, ncol = 3) + xlab("") + ylab("") +
theme_bw() + geom_hline(yintercept = 0, color = "red", alpha = 0.5) +
scale_x_continuous(breaks = seq(hd_pi_mp$t[1] %>% ceiling(),hd_pi_mp$t[nrow(hd_pi_mp)], 1)) +
annotate("rect", xmin = recessions_start, xmax = recessions_end, ymin = -Inf, ymax = Inf, alpha = 0.3)
ggsave("../Plots/hd_pi_mp.pdf", plot = hd_pi_mp_plot, width = 12, height = 6)
hd_pi_mp_plot <- hd_pi_mp %>% reshape2::melt(id = "t") %>% ggplot(aes(x = t, y = value)) +
geom_line() + facet_wrap(~variable, ncol = 3) + xlab("") + ylab("") +
theme_bw() + geom_hline(yintercept = 0, color = "red", alpha = 0.5) +
scale_x_continuous(breaks = seq(hd_pi_mp$t[1] %>% ceiling(),hd_pi_mp$t[nrow(hd_pi_mp)], by = 1)) +
annotate("rect", xmin = recessions_start, xmax = recessions_end, ymin = -Inf, ymax = Inf, alpha = 0.3)
ggsave("../Plots/hd_pi_mp.pdf", plot = hd_pi_mp_plot, width = 12, height = 6)
hd_pi_mp_plot <- hd_pi_mp %>% reshape2::melt(id = "t") %>% ggplot(aes(x = t, y = value)) +
geom_line() + facet_wrap(~variable, ncol = 3) + xlab("") + ylab("") +
theme_bw() + geom_hline(yintercept = 0, color = "red", alpha = 0.5) +
scale_x_continuous(breaks = seq(hd_pi_mp$t[1] %>% ceiling(),hd_pi_mp$t[nrow(hd_pi_mp)], by = 0.5)) +
annotate("rect", xmin = recessions_start, xmax = recessions_end, ymin = -Inf, ymax = Inf, alpha = 0.3)
ggsave("../Plots/hd_pi_mp.pdf", plot = hd_pi_mp_plot, width = 12, height = 6)
hd_pi_mp_plot <- hd_pi_mp %>% reshape2::melt(id = "t") %>% ggplot(aes(x = t, y = value)) +
geom_line() + facet_wrap(~variable, ncol = 3) + xlab("") + ylab("") +
theme_bw() + geom_hline(yintercept = 0, color = "red", alpha = 0.5) +
scale_x_continuous(breaks = seq(hd_pi_mp$t[1] %>% ceiling(),hd_pi_mp$t[nrow(hd_pi_mp)], by = 0.5)) +
annotate("rect", xmin = recessions_start, xmax = recessions_end, ymin = -Inf, ymax = Inf, alpha = 0.3)
ggsave("../Plots/hd_pi_mp.pdf", plot = hd_pi_mp_plot, width = 12, height = 6)
recessions_end <- c(1970.75, 1975, 1980.5,1982.75)
hd_pi_mp_plot <- hd_pi_mp %>% reshape2::melt(id = "t") %>% ggplot(aes(x = t, y = value)) +
geom_line() + facet_wrap(~variable, ncol = 3) + xlab("") + ylab("") +
theme_bw() + geom_hline(yintercept = 0, color = "red", alpha = 0.5) +
scale_x_continuous(breaks = seq(hd_pi_mp$t[1] %>% ceiling(),hd_pi_mp$t[nrow(hd_pi_mp)], by = 1)) +
annotate("rect", xmin = recessions_start, xmax = recessions_end, ymin = -Inf, ymax = Inf, alpha = 0.3)
ggsave("../Plots/hd_pi_mp.pdf", plot = hd_pi_mp_plot, width = 12, height = 6)
hd_pi_mp_plot <- hd_pi_mp %>% reshape2::melt(id = "t") %>% ggplot(aes(x = t, y = value)) +
geom_line() + facet_wrap(~variable, ncol = 3) + xlab("") + ylab("") +
theme_bw() + geom_hline(yintercept = 0, color = "red", alpha = 0.5) +
scale_x_continuous(breaks = seq(hd_pi_mp$t[1] %>% ceiling(),hd_pi_mp$t[nrow(hd_pi_mp)], by = 2)) +
annotate("rect", xmin = recessions_start, xmax = recessions_end, ymin = -Inf, ymax = Inf, alpha = 0.3)
ggsave("../Plots/hd_pi_mp.pdf", plot = hd_pi_mp_plot, width = 12, height = 6)
hd_pi_mp_plot <- hd_pi_mp %>% reshape2::melt(id = "t") %>% ggplot(aes(x = t, y = value)) +
geom_line() + facet_wrap(~variable, ncol = 3) + xlab("") + ylab("") +
theme_bw() + geom_hline(yintercept = 0, color = "red", alpha = 0.5) +
scale_x_continuous(breaks = seq(hd_pi_mp$t[1] %>% ceiling(),hd_pi_mp$t[nrow(hd_pi_mp)], by = 1.5)) +
annotate("rect", xmin = recessions_start, xmax = recessions_end, ymin = -Inf, ymax = Inf, alpha = 0.3)
ggsave("../Plots/hd_pi_mp.pdf", plot = hd_pi_mp_plot, width = 12, height = 6)
hd_pi_mp_plot <- hd_pi_mp %>% reshape2::melt(id = "t") %>% ggplot(aes(x = t, y = value)) +
geom_line() + facet_wrap(~variable, ncol = 3) + xlab("") + ylab("") +
theme_bw() + geom_hline(yintercept = 0, color = "red", alpha = 0.5) +
scale_x_continuous(breaks = seq(hd_pi_mp$t[1] %>% ceiling(),hd_pi_mp$t[nrow(hd_pi_mp)], by = 2)) +
annotate("rect", xmin = recessions_start, xmax = recessions_end, ymin = -Inf, ymax = Inf, alpha = 0.3)
ggsave("../Plots/hd_pi_mp.pdf", plot = hd_pi_mp_plot, width = 12, height = 6)
hd_pi_mp %<>% dplyr::filter(t >= 1973 & t <= 1983)
colnames(hd_pi_mp)[-1] <- c("SR", "dCov", "CV", "SW", "SZ", "RR")
recessions_start <- c(1969.75, 1973.75, 1980,1981.5)
recessions_end <- c(1970.75, 1975, 1980.5,1982.75)
hd_pi_mp_plot <- hd_pi_mp %>% reshape2::melt(id = "t") %>% ggplot(aes(x = t, y = value)) +
geom_line() + facet_wrap(~variable, ncol = 3) + xlab("") + ylab("") +
theme_bw() + geom_hline(yintercept = 0, color = "red", alpha = 0.5) +
scale_x_continuous(breaks = seq(hd_pi_mp$t[1] %>% ceiling(),hd_pi_mp$t[nrow(hd_pi_mp)], by = 2)) +
annotate("rect", xmin = recessions_start, xmax = recessions_end, ymin = -Inf, ymax = Inf, alpha = 0.3)
ggsave("../Plots/hd_pi_mp.pdf", plot = hd_pi_mp_plot, width = 12, height = 6)
## combined plot
hd_pi_mp <- hd_pi_SR_mp %>% left_join(hd_pi_dCov_mp, by = "t") %>%
left_join(hd_pi_CV_mp, by = "t") %>% left_join(hd_pi_SW_mp, by = "t") %>%
left_join(hd_pi_SZ_mp, by = "t") %>% left_join(hd_pi_RR_mp, by = "t") %>% tidyr::drop_na()
hd_pi_mp %<>% dplyr::filter(t >= 1973 & t <= 1983)
colnames(hd_pi_mp)[-1] <- c("SR", "dCov", "CV", "SW", "SZ", "RR")
recessions_start <- c(1969.75, 1973.75, 1980,1981.5)
recessions_end <- c(1970.75, 1975, 1980.5,1982.75)
hd_pi_mp_plot <- hd_pi_mp %>% reshape2::melt(id = "t") %>% ggplot(aes(x = t, y = value)) +
geom_line() + facet_wrap(~variable, ncol = 3) + xlab("") + ylab("") +
theme_bw() + geom_hline(yintercept = 0, color = "red", alpha = 0.5) +
scale_x_continuous(breaks = seq(hd_pi_mp$t[1] %>% ceiling(),hd_pi_mp$t[nrow(hd_pi_mp)], by = 2)) +
annotate("rect", xmin = recessions_start, xmax = recessions_end, ymin = -Inf, ymax = Inf, alpha = 0.3)
ggsave("../Plots/hd_pi_mp.pdf", plot = hd_pi_mp_plot, width = 12, height = 6)
hd_pi_mp_plot
seq(hd_pi_mp$t[1] %>% ceiling(),hd_pi_mp$t[nrow(hd_pi_mp)], by = 2)
recessions_end <- c( 1975, 1980.5,1982.75)
recessions_start <- c( 1973.75, 1980,1981.5)
recessions_end <- c( 1975, 1980.5,1982.75)
hd_pi_mp_plot <- hd_pi_mp %>% reshape2::melt(id = "t") %>% ggplot(aes(x = t, y = value)) +
geom_line() + facet_wrap(~variable, ncol = 3) + xlab("") + ylab("") +
theme_bw() + geom_hline(yintercept = 0, color = "red", alpha = 0.5) +
scale_x_continuous(breaks = seq(hd_pi_mp$t[1] %>% ceiling(),hd_pi_mp$t[nrow(hd_pi_mp)], by = 2)) +
annotate("rect", xmin = recessions_start, xmax = recessions_end, ymin = -Inf, ymax = Inf, alpha = 0.3)
ggsave("../Plots/hd_pi_mp.pdf", plot = hd_pi_mp_plot, width = 12, height = 6)
hd_pi_SR %>% plot.hd.mod()
hd_pi_CV
hd_pi_CV %>% dplyr::filter(t >= 1973 & t <= 1983)
hd_pi_CV %>% dplyr::filter(t >= 1981 & t <= 1983)
hd_pi_SR %>% plot.hd.mod()
hd_pi_CV %>% plot.hd.mod()
hd_pi_dCov %>% plot.hd.mod()
hd_pi_SW_mp %>% plot.hd.mod()
hd_pi_RR_mp %>% plot.hd.mod()
hd_pi_RR_mp %>% plot.hd.mod()
hd_pi_SW_mp %>% plot.hd.mod()
hd_pi_SR %>% plot.hd.mod()
hd_pi_CV %>% plot.hd.mod()
hd_pi_dCov %>% plot.hd.mod()
hd_pi_SW_mp
hd_pi_dCov
hd_pi_CV_mp
# Load functions ----------------------------------------------------------
rm(list = ls())
Functions <- devtools::as.package("../Functions")
devtools::load_all("../Functions")
library(ggfortify)
library(gridExtra)
library(magrittr)
library(svars)
library(readr)
#devtools::install_github("ropenscilabs/ochRe")
library(ochRe)
# Import data -------------------------------------------------------------
USA_Tri_raw   <- read.csv("Data/USA_Tri.csv")
USA_Tri       <- ts(USA_Tri_raw[,-1], frequency = 4, start = c(floor(USA_Tri_raw$Year[1]), (USA_Tri_raw$Year[1] %% 1) / 0.25 + 1 ))
#autoplot(USA_Tri, ncol = 1) + theme_bw()
# VAR Spesicifation -------------------------------------------------------
## lag length
#VARselect(USA_Tri, lag.max = 8)
var4 <- VAR(USA_Tri, p = 4, type = "const")
#var4 %>% summary
#var4 %>% resid %>% t() %>% write.table(file = "NonFundamentalness/resid.txt", col.names = F, row.names = F)
#apply(USA_Tri, 1, function(x){x-colMeans(USA_Tri)}) %>% t() %>% write.table(file = "NonFundamentalness/dat.txt", col.names = F, row.names = F)
## LM test for serial correlation
#serial.test(var4, type = "BG")
#serial.test(var4, type = "ES")
## detecting structural break
#set.seed(1234)
#chow.test(var4, SB = c(1984, 1), frequency = 4, nboot = 2000) %>% summary
#set.seed(1234)
#chow.test(var4, SB = c(1979, 3), frequency = 4, nboot = 2000) %>% summary
## Gaussianity test
#ICtest::FOBIboot(var4 %>% resid, n.boot = 2000, 1) # test against the last 2 components are gaussian: reject
#ICtest::FOBIboot(var4 %>% resid, n.boot = 2000, 2) # test against the last 1 component is gaussian: reject
#tseries::jarque.bera.test(resid(var4)[,1])
#tseries::jarque.bera.test(resid(var4)[,2])
#tseries::jarque.bera.test(resid(var4)[,3])
# Identification ----------------------------------------------------------
## Sign restrictions
set.seed(1234)
Signmat     <- matrix(c(1,1,1,-1,1,1,NA,-1,1), nrow = 3, ncol = 3)
SR          <- get.id.Sign(var4, Iter = 1000, Itermax = Inf, Signmat = Signmat, RHorizont = 0, Normalize = F, Step = 15, MT = T, Ci = 0.68, Plot = T, Hist = F, Epsname =  c("d", "s", "mp"))
## Identification by change in volatility
set.seed(1234)
CV          <- id.cv(var4, SB = c(1984, 1), frequency = 4)
CV          %>% summary
## Identification by minimizing distance covariance
set.seed(1234)
dCov        <- id.dc(var4)
dCov$B      <- dCov$B[,c(3,2,1)]
dCov$B[,3]  <- dCov$B[,3]*-1
dCov        %>% summary
## Identification by minimizing CvM distance
#set.seed(1234)
#CvM        <- id.cvm(var4, itermax = 2000, steptol = 200, iter2 = 200)
#CvM$B <- CvM$B[,c(3,2,1)]
#CvM$B[,1] <- CvM$B[,1] *-1
#CvM        %>% summary
#CvM %>% irf() %>% plot
#ggsave("../Plots/Tri_CvM.pdf", plot = last_plot(), width = 12, height = 8)
## Proxy SVAR
# Smets-Wouters (2007)
SW.raw      <- read.csv("Data/Instruments/SW.csv")
SW          <- ts(SW.raw[,-1], frequency = 4, start = c(floor(SW.raw$Year[1]), (SW.raw$Year[1] %% 1) / 0.25 + 1 ))
IV.SW       <- get.id.iv(var4, instruments = SW, Synchro = T)
IV.SW$B
IV.SW$F_test
#Box.test(SW, lag = 1, type = "Ljung-Box")
#Box.test(SW, lag = 2, type = "Ljung-Box")
#Box.test(SW, lag = 3, type = "Ljung-Box")
# Guerkaynak, Sack and Swanson (2005)
GSS.raw     <- read.csv("Data/Instruments/GSS.csv")
GSS         <- ts(GSS.raw[,-1], frequency = 4, start = c(floor(GSS.raw$Year[1]), (GSS.raw$Year[1] %% 1) / 0.25 + 1 ))
IV.GSS      <- get.id.iv(var4, instruments = GSS, Synchro = T)
IV.GSS$B
IV.GSS$F_test
# Romer Romer (2004)
RR.raw      <- read.csv("Data/Instruments/RR.csv")
RR          <- ts(RR.raw[,-1], frequency = 4, start = c(floor(RR.raw$Year[1]), (RR.raw$Year[1] %% 1) / 0.25 + 1 ))
RR          <- Remove_AC(RR, lag = 1)
IV.RR       <- get.id.iv(var4, instruments = RR, Synchro = T)
IV.RR$B
IV.RR$F_test
#Box.test(RR, lag = 1, type = "Ljung-Box")
#Box.test(RR, lag = 2, type = "Ljung-Box")
#Box.test(RR, lag = 3, type = "Ljung-Box")
# Sims Zha (2006)
SZ.raw      <- read.csv("Data/Instruments/SZ.csv")
SZ          <- ts(SZ.raw[,-1], frequency = 4, start = c(floor(SZ.raw$Year[1]), (SZ.raw$Year[1] %% 1) / 0.25 + 1 ))
SZ          <- Remove_AC(SZ, 2)
IV.SZ       <- get.id.iv(var4, instruments = SZ, Synchro = T)
IV.SZ$B
IV.SZ$F_test
#Box.test(SZ, lag = 1, type = "Ljung-Box")
#Box.test(SZ, lag = 2, type = "Ljung-Box")
#Box.test(SZ, lag = 3, type = "Ljung-Box")
#Box.test(SZ, lag = 4, type = "Ljung-Box")
Epsname = c("d", "s", "mp")
# pi ----------------------------------------------------------------------
hd_pi_SR <- hd.mod(SR, series = 2, Partial = NULL, Epsname)
hd_pi_SR_mp <- hd.mod(SR, series = 2, Partial = 3, Epsname)
hd_pi_CV <- hd.mod(CV, series = 2, Partial = NULL, Epsname)
hd_pi_CV_mp <- hd.mod(CV, series = 2, Partial = 3, Epsname)
hd_pi_dCov <- hd.mod(dCov, series = 2, Partial = NULL, Epsname)
hd_pi_dCov_mp <- hd.mod(dCov, series = 2, Partial = 3, Epsname)
hd_pi_SW_mp <- hd.mod(IV.SW, series = 2, Partial = 3, Epsname)
hd_pi_RR_mp <- hd.mod(IV.RR, series = 2, Partial = 3, Epsname)
hd_pi_SZ_mp <- hd.mod(IV.SZ, series = 2, Partial = 3, Epsname)
hd_pi_SR %>% plot.hd.mod()
# pi ----------------------------------------------------------------------
hd_pi_SR <- hd.mod(SR, series = 2, Partial = NULL, Epsname)
hd_pi_SR_mp <- hd.mod(SR, series = 2, Partial = 3, Epsname)
hd_pi_CV <- hd.mod(CV, series = 2, Partial = NULL, Epsname)
hd_pi_CV_mp <- hd.mod(CV, series = 2, Partial = 3, Epsname)
hd_pi_dCov <- hd.mod(dCov, series = 2, Partial = NULL, Epsname)
hd_pi_dCov_mp <- hd.mod(dCov, series = 2, Partial = 3, Epsname)
hd_pi_SW_mp <- hd.mod(IV.SW, series = 2, Partial = 3, Epsname)
hd_pi_RR_mp <- hd.mod(IV.RR, series = 2, Partial = 3, Epsname)
hd_pi_SZ_mp <- hd.mod(IV.SZ, series = 2, Partial = 3, Epsname)
hd_pi_SR %>% plot.hd.mod()
hd_pi_CV %>% plot.hd.mod()
hd_pi_dCov %>% plot.hd.mod()
hd_pi_SW_mp %>% plot.hd.mod()
hd_pi_RR_mp %>% plot.hd.mod()
hd_pi_SZ_mp %>% plot.hd.mod()
# x ----------------------------------------------------------------------
hd_x_SR <- hd.mod(SR, series = 1, Partial = NULL, Epsname)
hd_x_SR_mp <- hd.mod(SR, series = 1, Partial = 3, Epsname)
hd_x_CV <- hd.mod(CV, series = 1, Partial = NULL, Epsname)
hd_x_CV_mp <- hd.mod(CV, series = 1, Partial = 3, Epsname)
hd_x_dCov <- hd.mod(dCov, series = 1, Partial = NULL, Epsname)
hd_x_dCov_mp <- hd.mod(dCov, series = 1, Partial = 3, Epsname)
hd_x_SW_mp <- hd.mod(IV.SW, series = 1, Partial = 3, Epsname)
hd_x_RR_mp <- hd.mod(IV.RR, series = 1, Partial = 3, Epsname)
hd_x_SZ_mp <- hd.mod(IV.SZ, series = 1, Partial = 3, Epsname)
hd_x_SR %>% plot.hd.mod()
hd_x_CV %>% plot.hd.mod()
hd_x_dCov %>% plot.hd.mod()
hd_x_SW_mp %>% plot.hd.mod()
hd_x_RR_mp %>% plot.hd.mod()
hd_x_SZ_mp %>% plot.hd.mod()
hd_x_mp %>% reshape2::melt(id = "t") %>% ggplot(aes(x = t, y = value)) +
geom_line() + facet_wrap(~variable, ncol = 3) + xlab("") + ylab("") +
theme_bw() + geom_hline(yintercept = 0, color = "red", alpha = 0.5) +
scale_x_continuous(breaks = seq(hd_x_mp$t[1] %>% ceiling(),hd_x_mp$t[nrow(hd_x_mp)], by = 2)) +
annotate("rect", xmin = recessions_start, xmax = recessions_end, ymin = -Inf, ymax = Inf, alpha = 0.3)
hd_x_SR %>% plot.hd.mod()
hd_x_CV %>% plot.hd.mod()
hd_x_dCov %>% plot.hd.mod()
hd_x_SW_mp %>% plot.hd.mod()
hd_x_RR_mp %>% plot.hd.mod()
hd_x_SZ_mp %>% plot.hd.mod()
## combined plot
hd_x_mp <- hd_x_SR_mp %>% left_join(hd_x_dCov_mp, by = "t") %>%
left_join(hd_x_CV_mp, by = "t") %>% left_join(hd_x_SW_mp, by = "t") %>%
left_join(hd_x_SZ_mp, by = "t") %>% left_join(hd_x_RR_mp, by = "t") %>% tidyr::drop_na()
hd_x_mp %<>% dplyr::filter(t >= 1970 & t <= 1985)
colnames(hd_x_mp)[-1] <- c("SR", "dCov", "CV", "SW", "SZ", "RR")
hd_x_mp %>% reshape2::melt(id = "t") %>% ggplot(aes(x = t, y = value)) +
geom_line() + facet_wrap(~variable, ncol = 3) + xlab("") + ylab("") +
theme_bw() + geom_hline(yintercept = 0, color = "red", alpha = 0.5) +
scale_x_continuous(breaks = seq(hd_x_mp$t[1] %>% ceiling(),hd_x_mp$t[nrow(hd_x_mp)], by = 2)) +
annotate("rect", xmin = recessions_start, xmax = recessions_end, ymin = -Inf, ymax = Inf, alpha = 0.3)
## combined plot
hd_pi_mp <- hd_pi_SR_mp %>% left_join(hd_pi_dCov_mp, by = "t") %>%
left_join(hd_pi_CV_mp, by = "t") %>% left_join(hd_pi_SW_mp, by = "t") %>%
left_join(hd_pi_SZ_mp, by = "t") %>% left_join(hd_pi_RR_mp, by = "t") %>% tidyr::drop_na()
hd_pi_mp %<>% dplyr::filter(t >= 1973 & t <= 1983)
colnames(hd_pi_mp)[-1] <- c("SR", "dCov", "CV", "SW", "SZ", "RR")
recessions_start <- c( 1973.75, 1980,1981.5)
recessions_end <- c( 1975, 1980.5,1982.75)
hd_pi_mp_plot <- hd_pi_mp %>% reshape2::melt(id = "t") %>% ggplot(aes(x = t, y = value)) +
geom_line() + facet_wrap(~variable, ncol = 3) + xlab("") + ylab("") +
theme_bw() + geom_hline(yintercept = 0, color = "red", alpha = 0.5) +
scale_x_continuous(breaks = seq(hd_pi_mp$t[1] %>% ceiling(),hd_pi_mp$t[nrow(hd_pi_mp)], by = 2)) +
annotate("rect", xmin = recessions_start, xmax = recessions_end, ymin = -Inf, ymax = Inf, alpha = 0.3)
hd_x_mp %>% reshape2::melt(id = "t") %>% ggplot(aes(x = t, y = value)) +
geom_line() + facet_wrap(~variable, ncol = 3) + xlab("") + ylab("") +
theme_bw() + geom_hline(yintercept = 0, color = "red", alpha = 0.5) +
scale_x_continuous(breaks = seq(hd_x_mp$t[1] %>% ceiling(),hd_x_mp$t[nrow(hd_x_mp)], by = 2)) +
annotate("rect", xmin = recessions_start, xmax = recessions_end, ymin = -Inf, ymax = Inf, alpha = 0.3)
hd_x_mp %<>% dplyr::filter(t >= 1973 & t <= 1983)
colnames(hd_x_mp)[-1] <- c("SR", "dCov", "CV", "SW", "SZ", "RR")
hd_x_mp %>% reshape2::melt(id = "t") %>% ggplot(aes(x = t, y = value)) +
geom_line() + facet_wrap(~variable, ncol = 3) + xlab("") + ylab("") +
theme_bw() + geom_hline(yintercept = 0, color = "red", alpha = 0.5) +
scale_x_continuous(breaks = seq(hd_x_mp$t[1] %>% ceiling(),hd_x_mp$t[nrow(hd_x_mp)], by = 2)) +
annotate("rect", xmin = recessions_start, xmax = recessions_end, ymin = -Inf, ymax = Inf, alpha = 0.3)
hd_x_SR %>% plot.hd.mod()
hd_x_CV %>% plot.hd.mod()
hd_x_dCov %>% plot.hd.mod()
USA_Tri
hd_pi_SW_mp
hd_pi_CV
hd_pi_mp
# Load functions ----------------------------------------------------------
rm(list = ls())
Functions <- devtools::as.package("../Functions")
devtools::load_all("../Functions")
library(ggfortify)
library(gridExtra)
library(magrittr)
library(svars)
library(readr)
#devtools::install_github("ropenscilabs/ochRe")
library(ochRe)
# Import data -------------------------------------------------------------
USA_Tri_raw   <- read.csv("Data/USA_Tri.csv")
USA_Tri       <- ts(USA_Tri_raw[,-1], frequency = 4, start = c(floor(USA_Tri_raw$Year[1]), (USA_Tri_raw$Year[1] %% 1) / 0.25 + 1 ))
# VAR Spesicifation -------------------------------------------------------
## lag length
#VARselect(USA_Tri, lag.max = 8)
var4 <- VAR(USA_Tri, p = 4, type = "const")
# Identification ----------------------------------------------------------
## Sign restrictions
set.seed(1234)
Signmat     <- matrix(c(1,1,1,-1,1,1,NA,-1,1), nrow = 3, ncol = 3)
SR          <- get.id.Sign(var4, Iter = 1000, Itermax = Inf, Signmat = Signmat, RHorizont = 0, Normalize = F, Step = 15, MT = T, Ci = 0.68, Plot = T, Hist = F, Epsname =  c("d", "s", "mp"))
